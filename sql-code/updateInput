CREATE DEFINER=`readonly`@`%` PROCEDURE `updateInput`()
BEGIN

call ticket_to_use() ;

drop table if exists middleInput ;
create table middleInput

Select startinput.* ,case when ((calculatelink.epic_issuenum = startInput.Ticket_to_Use) AND calculatelink.column1 = 0) then round(sum(calculatelink.storyHours),0) else 0 end as Closed_Story_Points,
case when ((calculatelink.epic_issuenum = startInput.Ticket_to_Use) AND calculatelink.column1 = 1) then round(sum(calculatelink.storyHours),0) else 0 end as Remaining_Story_Points
from startinput left join calculatelink on calculatelink.epic_issuenum = startinput.Ticket_to_Use

group by Manual_JIRA, NRE_JIRA, Linked, customer, version ;

END
